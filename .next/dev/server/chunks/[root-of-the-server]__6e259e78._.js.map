{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 112, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/SreejaSangras/TMFG/src/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from '@prisma/client'\r\n\r\nconst globalForPrisma = globalThis as unknown as {\r\n  prisma: PrismaClient | undefined\r\n}\r\n\r\nexport const prisma = globalForPrisma.prisma ?? new PrismaClient()\r\n\r\nif (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = prisma\r\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,kBAAkB;AAIjB,MAAM,SAAS,gBAAgB,MAAM,IAAI,IAAI,6IAAY;AAEhE,wCAA2C,gBAAgB,MAAM,GAAG","debugId":null}},
    {"offset": {"line": 125, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/SreejaSangras/TMFG/src/app/api/auth/%5B...nextauth%5D/route.ts"],"sourcesContent":["import NextAuth, { NextAuthOptions } from 'next-auth'\r\nimport GoogleProvider from 'next-auth/providers/google'\r\nimport CredentialsProvider from 'next-auth/providers/credentials'\r\nimport { PrismaAdapter } from '@auth/prisma-adapter'\r\nimport { prisma } from '@/lib/prisma'\r\n\r\n// Admin emails that can login directly without email verification\r\nconst ADMIN_EMAILS = [\r\n  'themorningfamilygarden@gmail.com',\r\n  // Add more admin emails here\r\n]\r\n\r\nexport const authOptions: NextAuthOptions = {\r\n  adapter: PrismaAdapter(prisma),\r\n  providers: [\r\n    CredentialsProvider({\r\n      id: 'admin-login',\r\n      name: 'Admin Login',\r\n      credentials: {\r\n        email: { label: \"Email\", type: \"email\" },\r\n      },\r\n      async authorize(credentials) {\r\n        if (!credentials?.email) {\r\n          return null\r\n        }\r\n\r\n        // Check if email is in admin list\r\n        if (ADMIN_EMAILS.includes(credentials.email.toLowerCase())) {\r\n          // Create or get user\r\n          let user = await prisma.user.findUnique({\r\n            where: { email: credentials.email },\r\n          })\r\n\r\n          if (!user) {\r\n            user = await prisma.user.create({\r\n              data: {\r\n                email: credentials.email,\r\n                emailVerified: new Date(),\r\n              },\r\n            })\r\n          }\r\n\r\n          return {\r\n            id: user.id,\r\n            email: user.email,\r\n            name: user.name,\r\n            image: user.image,\r\n          }\r\n        }\r\n\r\n        return null\r\n      },\r\n    }),\r\n    GoogleProvider({\r\n      clientId: process.env.GOOGLE_CLIENT_ID || '',\r\n      clientSecret: process.env.GOOGLE_CLIENT_SECRET || '',\r\n    }),\r\n  ],\r\n  pages: {\r\n    signIn: '/auth/signin',\r\n    error: '/auth/error',\r\n    verifyRequest: '/auth/verify-request',\r\n  },\r\n  session: {\r\n    strategy: 'jwt',\r\n  },\r\n  callbacks: {\r\n    async jwt({ token, user }) {\r\n      if (user) {\r\n        token.id = user.id\r\n        token.email = user.email\r\n      }\r\n      return token\r\n    },\r\n    async session({ session, token }) {\r\n      if (session?.user) {\r\n        session.user.id = token.id as string\r\n        session.user.email = token.email as string\r\n      }\r\n      return session\r\n    },\r\n  },\r\n  secret: process.env.NEXTAUTH_SECRET,\r\n}\r\n\r\nconst handler = NextAuth(authOptions)\r\n\r\nexport { handler as GET, handler as POST }\r\n"],"names":[],"mappings":";;;;;;;;AAAA;AACA;AACA;AACA;AACA;;;;;;AAEA,kEAAkE;AAClE,MAAM,eAAe;IACnB;CAED;AAEM,MAAM,cAA+B;IAC1C,SAAS,IAAA,+KAAa,EAAC,wIAAM;IAC7B,WAAW;QACT,IAAA,6KAAmB,EAAC;YAClB,IAAI;YACJ,MAAM;YACN,aAAa;gBACX,OAAO;oBAAE,OAAO;oBAAS,MAAM;gBAAQ;YACzC;YACA,MAAM,WAAU,WAAW;gBACzB,IAAI,CAAC,aAAa,OAAO;oBACvB,OAAO;gBACT;gBAEA,kCAAkC;gBAClC,IAAI,aAAa,QAAQ,CAAC,YAAY,KAAK,CAAC,WAAW,KAAK;oBAC1D,qBAAqB;oBACrB,IAAI,OAAO,MAAM,wIAAM,CAAC,IAAI,CAAC,UAAU,CAAC;wBACtC,OAAO;4BAAE,OAAO,YAAY,KAAK;wBAAC;oBACpC;oBAEA,IAAI,CAAC,MAAM;wBACT,OAAO,MAAM,wIAAM,CAAC,IAAI,CAAC,MAAM,CAAC;4BAC9B,MAAM;gCACJ,OAAO,YAAY,KAAK;gCACxB,eAAe,IAAI;4BACrB;wBACF;oBACF;oBAEA,OAAO;wBACL,IAAI,KAAK,EAAE;wBACX,OAAO,KAAK,KAAK;wBACjB,MAAM,KAAK,IAAI;wBACf,OAAO,KAAK,KAAK;oBACnB;gBACF;gBAEA,OAAO;YACT;QACF;QACA,IAAA,wKAAc,EAAC;YACb,UAAU,QAAQ,GAAG,CAAC,gBAAgB,IAAI;YAC1C,cAAc,QAAQ,GAAG,CAAC,oBAAoB,IAAI;QACpD;KACD;IACD,OAAO;QACL,QAAQ;QACR,OAAO;QACP,eAAe;IACjB;IACA,SAAS;QACP,UAAU;IACZ;IACA,WAAW;QACT,MAAM,KAAI,EAAE,KAAK,EAAE,IAAI,EAAE;YACvB,IAAI,MAAM;gBACR,MAAM,EAAE,GAAG,KAAK,EAAE;gBAClB,MAAM,KAAK,GAAG,KAAK,KAAK;YAC1B;YACA,OAAO;QACT;QACA,MAAM,SAAQ,EAAE,OAAO,EAAE,KAAK,EAAE;YAC9B,IAAI,SAAS,MAAM;gBACjB,QAAQ,IAAI,CAAC,EAAE,GAAG,MAAM,EAAE;gBAC1B,QAAQ,IAAI,CAAC,KAAK,GAAG,MAAM,KAAK;YAClC;YACA,OAAO;QACT;IACF;IACA,QAAQ,QAAQ,GAAG,CAAC,eAAe;AACrC;AAEA,MAAM,UAAU,IAAA,0JAAQ,EAAC","debugId":null}},
    {"offset": {"line": 226, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/SreejaSangras/TMFG/src/lib/admin/auth.ts"],"sourcesContent":["import { getServerSession } from 'next-auth'\r\nimport { authOptions } from '@/app/api/auth/[...nextauth]/route'\r\n\r\n// List of admin emails - in production, this should be in database or environment variables\r\nconst ADMIN_EMAILS = [\r\n  \"themorningfamilygarden@gmail.com\",\r\n  // Add more admin emails here\r\n];\r\n\r\nexport async function isAdmin(): Promise<boolean> {\r\n  const session = await getServerSession(authOptions)\r\n\r\n  if (!session || !session.user?.email) {\r\n    return false\r\n  }\r\n\r\n  return ADMIN_EMAILS.includes(session.user.email)\r\n}\r\n\r\nexport async function requireAdmin() {\r\n  const admin = await isAdmin()\r\n\r\n  if (!admin) {\r\n    throw new Error('Unauthorized - Admin access required')\r\n  }\r\n\r\n  return true\r\n}\r\n\r\nexport async function getAdminSession() {\r\n  const session = await getServerSession(authOptions)\r\n  const admin = await isAdmin()\r\n\r\n  return {\r\n    session,\r\n    isAdmin: admin,\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;;;;;AAAA;AACA;;;AAEA,4FAA4F;AAC5F,MAAM,eAAe;IACnB;CAED;AAEM,eAAe;IACpB,MAAM,UAAU,MAAM,IAAA,mKAAgB,EAAC,iLAAW;IAElD,IAAI,CAAC,WAAW,CAAC,QAAQ,IAAI,EAAE,OAAO;QACpC,OAAO;IACT;IAEA,OAAO,aAAa,QAAQ,CAAC,QAAQ,IAAI,CAAC,KAAK;AACjD;AAEO,eAAe;IACpB,MAAM,QAAQ,MAAM;IAEpB,IAAI,CAAC,OAAO;QACV,MAAM,IAAI,MAAM;IAClB;IAEA,OAAO;AACT;AAEO,eAAe;IACpB,MAAM,UAAU,MAAM,IAAA,mKAAgB,EAAC,iLAAW;IAClD,MAAM,QAAQ,MAAM;IAEpB,OAAO;QACL;QACA,SAAS;IACX;AACF","debugId":null}},
    {"offset": {"line": 268, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/SreejaSangras/TMFG/src/app/api/admin/blog/%5Bid%5D/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server'\r\nimport { requireAdmin } from '@/lib/admin/auth'\r\nimport { prisma } from '@/lib/prisma'\r\n\r\n// Get single blog post\r\nexport async function GET(\r\n  request: NextRequest,\r\n  { params }: { params: Promise<{ id: string }> }\r\n) {\r\n  try {\r\n    await requireAdmin()\r\n    const { id } = await params\r\n\r\n    const post = await prisma.blogPost.findUnique({\r\n      where: { id }\r\n    })\r\n\r\n    if (!post) {\r\n      return NextResponse.json(\r\n        { error: 'Blog post not found' },\r\n        { status: 404 }\r\n      )\r\n    }\r\n\r\n    return NextResponse.json({ post })\r\n  } catch (error) {\r\n    console.error('Get blog post error:', error)\r\n\r\n    if (error instanceof Error && error.message.includes('Unauthorized')) {\r\n      return NextResponse.json(\r\n        { error: 'Unauthorized - Admin access required' },\r\n        { status: 401 }\r\n      )\r\n    }\r\n\r\n    return NextResponse.json(\r\n      { error: 'Failed to fetch blog post' },\r\n      { status: 500 }\r\n    )\r\n  }\r\n}\r\n\r\n// Update blog post\r\nexport async function PATCH(\r\n  request: NextRequest,\r\n  { params }: { params: Promise<{ id: string }> }\r\n) {\r\n  try {\r\n    await requireAdmin()\r\n    const { id } = await params\r\n    const body = await request.json()\r\n\r\n    const {\r\n      title,\r\n      slug,\r\n      content,\r\n      excerpt,\r\n      author,\r\n      category,\r\n      tags,\r\n      image,\r\n      published,\r\n      publishedAt\r\n    } = body\r\n\r\n    // Check if slug is being changed and if it already exists\r\n    if (slug) {\r\n      const existingPost = await prisma.blogPost.findFirst({\r\n        where: {\r\n          slug,\r\n          NOT: { id }\r\n        }\r\n      })\r\n\r\n      if (existingPost) {\r\n        return NextResponse.json(\r\n          { error: 'A blog post with this slug already exists' },\r\n          { status: 409 }\r\n        )\r\n      }\r\n    }\r\n\r\n    // Build update data object\r\n    const updateData: any = {}\r\n    if (title !== undefined) updateData.title = title\r\n    if (slug !== undefined) updateData.slug = slug\r\n    if (content !== undefined) updateData.content = content\r\n    if (excerpt !== undefined) updateData.excerpt = excerpt\r\n    if (author !== undefined) updateData.author = author\r\n    if (category !== undefined) updateData.category = category\r\n    if (tags !== undefined) updateData.tags = Array.isArray(tags) ? tags : []\r\n    if (image !== undefined) updateData.image = image\r\n    if (published !== undefined) {\r\n      updateData.published = published\r\n      // Auto-set publishedAt when publishing\r\n      if (published && !publishedAt) {\r\n        const currentPost = await prisma.blogPost.findUnique({\r\n          where: { id },\r\n          select: { publishedAt: true }\r\n        })\r\n        if (!currentPost?.publishedAt) {\r\n          updateData.publishedAt = new Date()\r\n        }\r\n      }\r\n    }\r\n    if (publishedAt !== undefined) updateData.publishedAt = publishedAt ? new Date(publishedAt) : null\r\n\r\n    const post = await prisma.blogPost.update({\r\n      where: { id },\r\n      data: updateData\r\n    })\r\n\r\n    return NextResponse.json({\r\n      message: 'Blog post updated successfully',\r\n      post\r\n    })\r\n  } catch (error) {\r\n    console.error('Update blog post error:', error)\r\n\r\n    if (error instanceof Error && error.message.includes('Unauthorized')) {\r\n      return NextResponse.json(\r\n        { error: 'Unauthorized - Admin access required' },\r\n        { status: 401 }\r\n      )\r\n    }\r\n\r\n    return NextResponse.json(\r\n      { error: 'Failed to update blog post' },\r\n      { status: 500 }\r\n    )\r\n  }\r\n}\r\n\r\n// Delete blog post\r\nexport async function DELETE(\r\n  request: NextRequest,\r\n  { params }: { params: Promise<{ id: string }> }\r\n) {\r\n  try {\r\n    await requireAdmin()\r\n    const { id } = await params\r\n\r\n    await prisma.blogPost.delete({\r\n      where: { id }\r\n    })\r\n\r\n    return NextResponse.json({\r\n      message: 'Blog post deleted successfully'\r\n    })\r\n  } catch (error) {\r\n    console.error('Delete blog post error:', error)\r\n\r\n    if (error instanceof Error && error.message.includes('Unauthorized')) {\r\n      return NextResponse.json(\r\n        { error: 'Unauthorized - Admin access required' },\r\n        { status: 401 }\r\n      )\r\n    }\r\n\r\n    return NextResponse.json(\r\n      { error: 'Failed to delete blog post' },\r\n      { status: 500 }\r\n    )\r\n  }\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}